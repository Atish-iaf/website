{{ $link := .Destination }}
{{ if not (strings.HasPrefix $link "http") }}
    {{ if strings.HasSuffix .Page.Parent.RelPermalink "docs/" }}
        {{ $link = path.Join .Page.RelPermalink .Destination }}
    {{ else if in $link "assets/" }}
        {{ $link = path.Join .Page.RelPermalink ".." .Destination }}
    {{ end }}
{{ end }}

<p>
    <img src="{{ $link | safeURL }}" alt="{{ .Text }}" {{ with .Title}} title="{{ . }}"{{ end }} />
</p>
